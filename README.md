# 微信公众号文章抓取工具

这个工具可以自动操控Mac上的微信应用，获取公众号的文章列表。

## 功能特点

- 自动启动并控制Mac上的微信应用
- 搜索并打开指定的公众号
- 自动滚动并捕获文章列表
- 使用OCR技术识别文章标题
- 将文章列表保存到文本文件

## 安装依赖

1. 安装Tesseract OCR引擎（高级版需要）:

```bash
brew install tesseract
brew install tesseract-lang  # 安装中文语言包
```

2. 安装Python依赖:

```bash
pip install -r requirements_wechat.txt
```

## 使用方法

### 基础版

基础版使用模拟鼠标和键盘操作来控制微信，并使用简单的方法捕获文章。

```bash
python crawl_desktop.py
```

### 高级版

高级版使用OCR技术来识别文章标题，提供更准确的结果。

```bash
python crawl_desktop_advanced.py
```

## 使用注意事项

1. 运行脚本前，请确保您的Mac上已安装微信应用
2. 运行过程中，请不要移动鼠标或使用键盘，以免干扰自动化操作
3. 如果微信未登录，脚本会等待几秒钟，请在这段时间内手动登录
4. 如果需要中断程序，可以按Ctrl+C

## 自定义配置

脚本中的一些参数可能需要根据您的屏幕尺寸和微信界面布局进行调整：

- `detect_articles_region()` 方法中的区域坐标
- OCR相关的图像预处理参数
- 滚动速度和间隔

## 常见问题

- 如果OCR识别不准确，可能需要调整图像预处理参数
- 如果点击位置不正确，请调整区域坐标
- 确保微信窗口处于前台且可见状态

## 许可证

MIT 